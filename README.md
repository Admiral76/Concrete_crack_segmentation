# Проект по сегментации трещин в бетоне

<p align="center">
  <img src="https://cdn.datasetninja.com/previews/q/ext:jpeg/resize:fill:400:0:0/q:70/plain/supervisely-supervisely-assets-public/images/original/y/6/eY/ZkOiwekRPuAKOcKgjBD8gIfJjiOkgkkwiHspoxjxPeFWGZiOhrg5pHu3dt5MWADI2Vhns6uiKuAR0kOcY1VL69lwnVq0sJBxZadji9GvSIJhh2PT61ee2ZdmUDeR.jpg" alt="Оригинальное изображение" width="500">
  <img src="https://cdn.datasetninja.com/masks?project_id=1837&image_id=2597610" alt="Маска" width="500">
</p>

## 1. Описание проекта

### 1.1. Формулировка задачи

**Цель:** Разработка модели машинного обучения для автоматической сегментации трещин на изображениях бетонных поверхностей.

**Зачем это нужно:**
* **Автоматизация инспекции:** В настоящее время инспекция бетонных конструкций на наличие трещин требует значительных затрат времени и человеческих ресурсов. Автоматическая сегментация трещин позволит ускорить и удешевить этот процесс.
* **Раннее обнаружение:** Раннее обнаружение трещин является критически важным для предотвращения более серьезных повреждений и потенциальных аварий, особенно в строительной отрасли.
* **Повышение безопасности:** Своевременное выявление и устранение трещин может предотвратить обрушения зданий и сооружений, обеспечивая безопасность для людей.
* **Поддержка принятия решений:**  Точная и быстрая информация о состоянии бетонных конструкций поможет инженерам принимать более обоснованные решения о ремонте и обслуживании.
* **Улучшение процесса контроля качества:**  Автоматизированная система сегментации трещин может быть использована для контроля качества новых бетонных конструкций и гарантии их долговечности.

В проекте мы будем решать задачу семантической сегментации, что означает, что мы будем идентифицировать на каждом пикселе изображения, принадлежит ли он к трещине или к фону, без разделения отдельных трещин.

### 1.2. Данные

**Источник данных:**
* **Датасет:** Concrete Crack Segmentation Dataset
* **Ссылка:** [Описание](https://datasetninja.com/concrete-crack-segmentation-dataset#introduction) | [Ссылка на скачивание](https://prod-dcd-datasets-cache-zipfiles.s3.eu-west-1.amazonaws.com/jwsn7tfbrp-1.zip)
* **Описание:**  Данный датасет содержит 458 изображений высокого разрешения бетонных поверхностей с соответствующими бинарными масками, где белые пиксели представляют трещины, а черные - фон. Изображения были сняты в различных зданиях на территории Ближневосточного Технического Университета (Middle East Technical University).
* **Размер:** 458 изображений
* **Классы:** Два класса: трещина и фон.
* **Тип аннотаций:**  Pixel-level semantic segmentation masks (бинарные маски).

**Особенности данных:**
* **Высокое разрешение:** Изображения имеют высокое разрешение, что позволяет обучать модель для обнаружения даже мелких трещин.
* **Разнообразие условий:**  Изображения были сделаны в разных зданиях, что обеспечивает разнообразие условий освещения, фона и вида трещин, повышая обобщающую способность модели.
* **Сбалансированные данные:** В датасете присутствует как примеры с четко выраженными трещинами, так и с более сложными ситуациями, что важно для обучения надежной модели.
* **Отсутствие разбиения на сеты:** Датасет не имеет готового разбиения на обучающую, валидационную и тестовую выборки.

**Возможные проблемы:**
* **Несовершенство разметки:** В некоторых случаях маски могут быть не идеальными, что может повлиять на качество обучения.
* **Неоднородность трещин:** Различные типы трещин (тонкие, широкие, разветвленные) могут затруднить обучение.
* **Сложный фон:** Наличие различных текстур и дефектов бетона может усложнить процесс обучения.
* **Ограниченный объем данных:** 458 изображений, хотя и достаточно для начала, может быть недостаточно для достижения максимальной производительности модели. Будем использовать аугментацию данных.

**Обоснование достаточности данных:**

* **Качество данных:** Изображения высокого разрешения и качественные маски позволяют обучить модель, способную улавливать детали.
* **Представление проблемы:** Данные отражают реальную задачу - обнаружение трещин на бетоне, что делает модель применимой на практике.
* **Возможность аугментации:**  Использование аугментации данных поможет увеличить объем обучающей выборки и сделать модель более устойчивой к вариативности данных.

Несмотря на ограниченный объем, датасет вполне подходит для решения задачи сегментации трещин.

### 1.3. Подход к моделированию

**Используемые модели и библиотеки:**
* **Библиотека:** PyTorch.
* **Модель:**  Будет использована архитектура **U-Net** или ее модификации (например, UNet++, DeepLabv3+).
* **Предобученные веса:**  Вероятно будут использованы предобученные веса.
* **Функция потери:**  BCEWithLogitsLoss (бинарная кросс-энтропия с логитами), т.к. это задача бинарной классификации.  Также возможно использование Dice loss или Focal Loss.
* **Оптимизатор:**  Adam или AdamW.
* **Метрики:** Dice Score и IoU для оценки качества сегментации.

**Конфигурация решения:**
1. **Разбиение данных:**  Разбиение датасета на обучающую (70%), валидационную (15%) и тестовую (15%) выборки.
2. **Предобработка данных:**
    * Изменение размера изображений до стандартного размера (например, 256x256 или 512x512).
    * Нормализация пиксельных значений.
    * Аугментация данных (случайные повороты, масштабирование, сдвиги, изменения яркости и контраста) для увеличения размера обучающей выборки и уменьшения переобучения.
3. **Обучение модели:** Обучение модели с использованием выбранной архитектуры, функции потерь и оптимизатора.
4. **Валидация модели:** Использование валидационной выборки для контроля за процессом обучения и подбора гиперпараметров.
5. **Тестирование модели:**  Оценка качества модели на тестовой выборке.
6. **Визуализация результатов:** Отображение предсказаний модели на нескольких тестовых изображениях.

### 1.4. Способ предсказания

После обучения модели, она будет интегрирована в пайплайн для применения на новых изображениях.

**Этапы пайплайна:**
1. **Загрузка нового изображения.**
2. **Предобработка изображения**. Применение тех же операций предобработки, которые использовались при обучении (изменение размера, нормализация).
3. **Предсказание модели**. Подача предобработанного изображения на вход обученной модели.
4. **Постобработка предсказаний:**
    - Преобразование логитов, выданных моделью, в вероятности (с использованием сигмоиды).
    - Применение порогового значения для получения бинарной маски (0 - фон, 1 - трещина).
    - Возможное применение фильтрации для удаления небольших областей, которые могут быть ложными срабатываниями.
5. **Визуализация/вывод результатов:**
    - Отображение исходного изображения с наложенной маской трещин.
    - Сохранение бинарной маски в отдельный файл.
    - Интеграция в более крупную систему анализа изображений, например, для автоматизированного отчета об инспекции.
